try{(window["WAFQualtricsWebpackJsonP-cloud-1.101.0"]=window["WAFQualtricsWebpackJsonP-cloud-1.101.0"]||[]).push([[5,7],{23:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n(24);var i=window.QSI.EmbeddedData},24:function(e,t,n){QSI.EmbeddedData&&!window.QTest||(QSI.EmbeddedData={getHTMLFromDOM:function(e){var t=QSI.util.$(e),n="";if(t)switch(t.tagName){case"TEXTAREA":case"INPUT":n=t.value;break;default:n=t.innerHTML}return n},getDataLayerVal:function(e){var t=window.QSI.InitializeDataLayerHelper().get(e);return t&&"object"==typeof t&&(t=JSON.stringify(t)),t||""},getCookieVal:function(e){var t="",n=QSI.cookie.get(e);return n&&(t=n),t},getURLParameter:function(e){return QSI.util.getQueryParam(window.location.href,e)},getURLRegexMatch:function(e){var t=e.match(/^\/(.*)\/([gim]*)/);return(t=t&&t[1]?window.location.href.match(new RegExp(t[1],t[2])):window.location.href.match(new RegExp(e)))&&t[1]?t[1]:""},getAdobeMarketingCloudIDJson:function(e){var t="";try{var n=Visitor.getInstance(e).getMarketingCloudVisitorID();t=JSON.stringify({marketingCloudVisitorID:n})}catch(e){QSI.dbg.e(e)}return t},getJavaScriptValue:function(e){var t="";try{if("object"==typeof e&&(e=e.toString()),QSI.global.enableJSSanitization||void 0===QSI.doEvalJS)return QSI.config&&!0===QSI.config.enableSecureVariables?t=QSI.strToVal(e):QSI.dbg.e("Error: JavaScript Evaluation has been disabled. Attempted to execute: '"+e+"'"),t;t=QSI.doEvalJS(e)}catch(e){QSI.dbg.e(e)}return t},getHistory:function(){return QSI.history.get()},getTimeOnSite:function(){return QSI.history.getTimeOnSite()},getCurrentPage:function(){return decodeURI(this.getWindowLocation())},getWindowLocation:function(){return window.location},getReferer:function(){return QSI.history.getPageReferrer()},getSiteReferer:function(){return QSI.history.getSiteReferrer()},getSearchTerm:function(){return QSI.history.getSearch()},getPageCount:function(){return QSI.history.getPageCount().unique},getTotalPageCount:function(){return QSI.history.getPageCount().total},getPercentagePageViewed:function(){return QSI.history.getPageCount().unique},getSiteInterceptID:function(){return this.siid},getCreativeID:function(){if(QSI.global.intercepts[this.siid]&&QSI.global.intercepts[this.siid].CreativeID)return QSI.global.intercepts[this.siid].CreativeID},getEventTrackingData:function(e){return QSI.EventTracker.get(e)},getSiteCatalystValue:function(e){for(var t,n=e.split("."),i=QSI.adobeVar.split("."),s=window,r=0;r<i.length;r++)s=s[i[r]];if(0===e.indexOf("event")&&s){var o=e+"=",a=s.events;if(a)for(var c=a.split(","),u=0;u<c.length;u++){var d=c[u],l=d.indexOf(o);if(~l)return d.substring(l+o.length,d.length)}}u=0;for(var h=n.length;u<h;u++){if(s)s=s[(t=n[u]).charAt(0).toLowerCase()+t.slice(1)]||s[n[u]]}return s||""},getUserAgent:function(){return navigator.userAgent},getBrowser:function(){return QSI.Browser.name},getBrowserVersion:function(){return QSI.Browser.version},getOperatingSystem:function(){return QSI.OS.name},getDeviceType:function(){return QSI.Browser.isMobile?"Mobile":"Desktop"},getEmbeddedData:function(e,t){t=t||[],QSI.ed[e]&&(t=t.concat(QSI.ed[e])),this.siid=e;const n=this.generateDynamicEmbeddedData(t);return window.QSI.SR&&window.QSI.SR.isOn()&&(n.Q_SR_ID=window.QSI.SR.getId(),n.Q_SR_PlaybackUrl=window.QSI.SR.getPlaybackUrl()),n},getUrlWithEmbeddedData:function(e){var t=e.url,n=e.targetType,i=e.requestId,s=e.interceptId,r=e.ed,o=e.creativeType,a=e.usingPopUnderTarget;if(!t)return"";var c=[QSI.util.creativeTypes.POP_UNDER],u=QSI.util.usePostToStart(n)&&!QSI.util.arrIncludes(c,o)&&!a;const d=this.getEmbeddedData(s,r);var l=d.Q_TS_ID&&d.Q_TS_RS&&d.Q_EE_ANON?{Q_TS_ID:d.Q_TS_ID,Q_TS_RS:d.Q_TS_RS,Q_EE_ANON:d.Q_EE_ANON}:{},h=u?l:d;return this.mergeEmbeddedDataIntoURL(t,h,i,s,u)},getEmbeddedDataAsArray:function(e,t,n,i){var s=[],r=this.getEmbeddedData(e,n);for(var o in i&&(this.surveyOpenED[e]=r),r){n={key:o,value:r[o]};s.push(n)}var a=this.generateQTouchpoint(t,e);if(a){n={key:"Q_Touchpoint",value:a};s.push(n)}return s},mergeEmbeddedDataIntoURL:function(e,t,n,i,s){var r,o;if(-1!==e.indexOf("?")){var a=e.split("?");r=a[0],o=this.getQueryParamsObjectFromString(a[1])}else r=e,o={};for(var c in t)o[c]=t[c];if(!s){var u=this.generateQTouchpoint(n,i);u&&(o.Q_Touchpoint=u)}var d=QSI.util.buildQueryString(o);return d?r+"?"+d:r},generateQTouchpoint:function(e,t){var n;if(e&&window.QSI.Request[e]&&t&&window.QSI.Request[e].Intercepts[t]){var i=window.QSI.Request[e].Intercepts[t].Targeting;i.ContactID&&i.DistributionID&&i.DirectoryID&&(n=i.DistributionID+"_"+i.ContactID+"_"+i.DirectoryID)}return n},getQueryParamsObjectFromString:function(e){var t={};if(!e)return t;for(var n=e.split("&"),i=0;i<n.length;i++){var s=n[i].split("=");t[s[0]]=s[1]}return t},getEmbeddedDataAsQueryStringParam:function(e,t){var n=this.getEmbeddedData(e,t);return 0===Object.keys(n).length?"":QSI.util.buildQueryString(n)},generateDynamicEmbeddedData:function(e){QSI.dbg.log("SI-4479 generateDynamicEmbeddedData start of function.  QSI.ed: "+JSON.stringify(QSI.ed)+"  ed: "+JSON.stringify(e));var t={};"string"==typeof e&&(e=e.split(""));for(var n=0,i=e.length;n<i;n++)try{var s=e[n];if(s.type&&s.name){var r="";switch(s.type){case"StaticVal":r=s.value;break;case"HTML":r=this.getHTMLFromDOM(s.value);break;case"Cookie":r=this.getCookieVal(s.value);break;case"QueryParam":r=this.getURLParameter(s.value);break;case"URLRegex":r=this.getURLRegexMatch(s.value);break;case"JavaScriptVal":r=this.getJavaScriptValue(s.value);break;case"SiteCatalyst":r=this.getSiteCatalystValue(s.value);break;case"EventTracking":r=this.getEventTrackingData(s.value);break;case"AdobeOrgID":r=this.getAdobeMarketingCloudIDJson(s.value);break;case"GoogleDataLayer":window.QSI.global.featureFlags["DX.GoogleDataLayer"]&&(r=this.getDataLayerVal(s.value));break;default:this["get"+s.type]?r=this["get"+s.type](s.value):0===s.value.indexOf("JSON.stringify")&&-1!==s.value.indexOf("marketingCloudVisitorID")?(QSI.dbg.log("SI-4479 generateDynamicEmbeddedData Attempting default case getJavaScriptValue fix. QSI.ed: "+JSON.stringify(QSI.ed)+"  set: "+JSON.stringify(s)),r=this.getJavaScriptValue(s.value)):(QSI.dbg.log("SI-4479 generateDynamicEmbeddedData Final else case in default QSI.ed: "+JSON.stringify(QSI.ed)+"  set: "+JSON.stringify(s)),r=s.value)}"XMDContactED"!==s.type&&(r=String(r),t[s.name]=r)}}catch(e){QSI.dbg.e(e)}return t},surveyOpenED:{}})},36:function(e,t,n){"use strict";n.r(t);var i=function(e,t){this.payload=t,this.type=e};n.d(t,"addPopunderEmbeddedDataHandler",(function(){return s})),n.d(t,"setEmbeddedData",(function(){return o})),n.d(t,"updatePopunderEDCallback",(function(){return a})),n.d(t,"persistEDToSurvey",(function(){return c}));var s=function(e){var t=window.QSI,n=t.util,i=t.windowHandler,s=t.dbg;n.observe(window,"beforeunload",e,!0);try{i.setupWindowHandles()}catch(e){s.e(e)}},r=function(e,t){if("string"==typeof e&&"string"==typeof t){var n=window.QSI.windowHandler,s=n.getWin(t);if(s){var r=new i("setTargetUrlInPlaceholderWindow",e),o=JSON.stringify(r),a=n.getWindowOrigin(window);s.postMessage(o,a)}}},o=function(e,t,n,s){if(void 0!==e&&void 0!==t&&"string"==typeof n&&"string"==typeof s){var r=window.QSI,o=r.windowHandler,a=r.dbg,c=o.getWin(n);if(c){var u=new i("setEmbeddedData",{key:e,value:t}),d=JSON.stringify(u);if(/targetwindow/.test(n))c.postMessage(d,s);else try{var l=c.document.getElementById("PopUnderTargetFrame");if(l&&l.contentWindow)l.contentWindow.postMessage(d,s)}catch(e){a.e(e)}}}},a=function(){var e=window.QSI.dbg;try{var t=window.QSI.windowHandler;t.removeClosedWindowHandles();var n=t.getOptInIDsAndWindowNames()||{},i=t.getOptInIDsAndTargetOrigins()||{};for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){var a=n[s],c=i[s]||"*",u=window.QSI.EmbeddedData,d=u.getEmbeddedData(s);if(!d||window.QSI.util.isObjectEmpty(d))continue;if(window.QSI.reg[s]&&/placeholderWindow/.test(a)){var l=window.QSI.reg[s].getTarget();return void r(l,a)}var h=u.surveyOpenED[s];for(var S in d)!Object.prototype.hasOwnProperty.call(d,S)||null!=h&&h[S]==d[S]||o(S,d[S],a,c)}}catch(t){e.e(t)}},c=function(e,t,n){var s=window.QSI,r=s.dbg,o=s.global,a=new i("setEmbeddedData",{key:t,value:n});try{e instanceof HTMLIFrameElement?e.contentWindow.postMessage(a,o.brandBaseUrl||"/"):e.postMessage(a,o.brandBaseUrl||"/")}catch(e){r.e(e)}}},66:function(e,t,n){"use strict";n.r(t);var i,s=n(44);!function(e){e.FullSnapshot="FullSnapshot",e.PageChanged="PageChanged",e.SignalCaptured="SignalCaptured",e.ChunkEndMarker="ChunkEndMarker"}(i||(i={}));var r,o,a=function(){function e(){}return e.prototype.generateTimelineEvent=function(e,t){var n=void 0,r=void 0;switch(e.type){case s.EventType.FullSnapshot:n=i.FullSnapshot;break;case s.EventType.Meta:n=i.PageChanged,r={href:e.data.href};break;case s.EventType.Custom:n=i.SignalCaptured,r={signalId:e.data.tag,signalSlot:null};break;default:return null}return{eventKey:{type:n,timestamp:e.timestamp},chunkNumber:t,eventDetails:r}},e.prototype.generateChunkEndMarker=function(e,t){return{eventKey:{type:i.ChunkEndMarker,timestamp:e},chunkNumber:t}},e}(),c=n(27),u=function(){function e(){}return e.prototype.startListening=function(e){window.triggerExampleSignal=function(t){e(t,{exampleMetadatKey:"exampleMetadataValue"}),console.log("example signal recorded")}},e.prototype.stopListening=function(){window.triggerExampleSignal=null},e}(),d=function(){function e(){this.isListening=!1}return e.prototype.startListening=function(t){this.isListening||(this.messageEventHandler=function(n){var i=n.origin,s=n.data;if((!window.QSI.Orchestrator||!window.QSI.Orchestrator.isMessageEventOriginAllowed||window.QSI.Orchestrator.isMessageEventOriginAllowed(i))&&"string"==typeof s&&s.startsWith("QualtricsEOS")){var r=s.match(/^QualtricsEOS\|(SV_[0-9a-zA-Z]{11,15})\|(FS_[0-9a-zA-Z]{11,15})$/);if(r){var o=r[1],a=r[2];t(e.SURVEY_TAKEN_SIGNAL_NAME,{surveyId:o,surveySessionId:a})}}},window.addEventListener("message",this.messageEventHandler),this.isListening=!0)},e.prototype.stopListening=function(){this.isListening&&(window.removeEventListener("message",this.messageEventHandler),this.isListening=!1)},e.SURVEY_TAKEN_SIGNAL_NAME="QualtricsSurveyTaken",e}(),l=function(){function e(){var t=this;this.evaluateForRageSignal=function(n,i,s){var r={eventX:n,eventY:i,time:s},o=t.ragePressHistory.length;if(0===o)return t.ragePressHistory.push(r),void(t.isRageStreak=!1);var a=t.ragePressHistory[o-1];t.arePressesCloseTogether(a,r)?(t.ragePressHistory.push(r),t.ragePressHistory.length>=e.NUM_CLICKS_THRESHOLD&&!t.isRageStreak&&(t.isRageStreak=!0,t.recordSignalCallback(e.RAGE_CLICK_SIGNAL_NAME,{}))):(t.isRageStreak=!1,t.ragePressHistory=[r])},this.rageClickListenerFn=function(e){t.elementCanBeRageClicked(e.target)&&t.evaluateForRageSignal(e.clientX,e.clientY,performance.now())},this.rageTapListenerFn=function(e){t.elementCanBeRageClicked(e.target)&&t.evaluateForRageSignal(e.clientX,e.clientY,performance.now())},this.arePressesCloseTogether=function(t,n){return Math.abs(t.eventX-n.eventX)<=e.PIXELS_BETWEEN_CLICKS_THRESHOLD&&Math.abs(t.eventY-n.eventY)<=e.PIXELS_BETWEEN_CLICKS_THRESHOLD&&Math.abs(t.time-n.time)<=e.MS_BETWEEN_CLICKS_THRESHOLD},this.elementCanBeRageClicked=function(e){return!("INPUT"===e.tagName.toUpperCase()&&"NUMBER"==e.type.toUpperCase())},this.isListening=!1}return e.prototype.startListening=function(e){this.isListening||(this.ragePressHistory=[],this.recordSignalCallback=e,window.QSI.Browser.isMobile?window.addEventListener("pointerup",this.rageTapListenerFn):window.addEventListener("click",this.rageClickListenerFn),this.isListening=!0)},e.prototype.stopListening=function(){this.isListening&&(window.removeEventListener("click",this.rageClickListenerFn),window.removeEventListener("pointerup",this.rageTapListenerFn),this.isListening=!1)},e.RAGE_CLICK_SIGNAL_NAME="RageClick",e.NUM_CLICKS_THRESHOLD=4,e.MS_BETWEEN_CLICKS_THRESHOLD=300,e.PIXELS_BETWEEN_CLICKS_THRESHOLD=200,e}(),h=function(){function e(){var t=this;this.errorListenerFn=function(){t.pressEvent&&t.recordSignalCallback(e.ERROR_PRESS_SIGNAL_NAME,{})},this.clickListenerFn=function(){t.pressEvent=!0,t.pressTimeout&&clearTimeout(t.pressTimeout),t.pressTimeout=window.setTimeout(t.resetPressEvent,e.ERROR_CLICK_MS_THRESHOLD)},this.tapListenerFn=function(){t.pressEvent=!0,t.pressTimeout&&clearTimeout(t.pressTimeout),t.pressTimeout=window.setTimeout(t.resetPressEvent,e.ERROR_TAP_MS_THRESHOLD)},this.resetPressEvent=function(){t.pressEvent=!1},this.isListening=!1,this.pressEvent=!1}return e.prototype.startListening=function(e){this.isListening||(this.recordSignalCallback=e,window.QSI.Browser.isMobile?window.addEventListener("pointerup",this.tapListenerFn,!0):window.addEventListener("click",this.clickListenerFn,!0),window.addEventListener("error",this.errorListenerFn),this.isListening=!0)},e.prototype.stopListening=function(){this.isListening&&(this.pressEvent=null,window.removeEventListener("click",this.clickListenerFn,!0),window.removeEventListener("pointerup",this.tapListenerFn,!0),window.removeEventListener("error",this.errorListenerFn),clearTimeout(this.pressTimeout),this.isListening=!1,this.pressEvent=!1)},e.ERROR_PRESS_SIGNAL_NAME="ErrorClick",e.ERROR_CLICK_MS_THRESHOLD=50,e.ERROR_TAP_MS_THRESHOLD=500,e}(),S=function(){function e(){var t=this;this.detectThrashing=function(){var n=window.QSI.Browser.isMobile,i=n?t.detectTouchThrashing():t.detectMouseThrashing();i&&!t.isThrashing&&(t.recordSignalCallback(e.THRASH_SIGNAL_NAME,{}),t.isThrashing=!0),i||(t.isThrashing=!1),n||(t.xDistance=0,t.yDistance=0,t.xDirectionChangeCount=0,t.yDirectionChangeCount=0)},this.detectMouseThrashing=function(){var n=t.xDistance/e.INTERVAL_MS,i=t.yDistance/e.INTERVAL_MS;return(t.xDirectionChangeCount>=e.NUM_DIRECTION_CHANGES_THRESHOLD||t.yDirectionChangeCount>=e.NUM_DIRECTION_CHANGES_THRESHOLD)&&(n>=e.VELOCITY_THRESHOLD||i>=e.VELOCITY_THRESHOLD)},this.detectTouchThrashing=function(){var n=!1;if(t.trackedTouch&&!t.trackedTouch.hasThrashed){var i=t.trackedTouch.xDistance/e.INTERVAL_MS,s=t.trackedTouch.yDistance/e.INTERVAL_MS;(t.trackedTouch.xDirectionChangeCount>=e.NUM_DIRECTION_CHANGES_THRESHOLD||t.trackedTouch.yDirectionChangeCount>=e.NUM_DIRECTION_CHANGES_THRESHOLD)&&(i>=e.VELOCITY_THRESHOLD||s>=e.VELOCITY_THRESHOLD)&&(n=!0,t.trackedTouch.hasThrashed=!0)}return n},this.mouseListenerFn=function(e){var n=Math.sign(e.movementX),i=Math.sign(e.movementY);t.xDistance+=Math.abs(e.movementX),t.yDistance+=Math.abs(e.movementY),0!=n&&n!==t.xDirection&&(t.xDirection=n,t.xDirectionChangeCount++),0!=i&&i!==t.yDirection&&(t.yDirection=i,t.yDirectionChangeCount++)},this.dragListenerFn=function(e){var n={movementX:e.clientX-t.xDragPosition,movementY:e.clientY-t.yDragPosition};t.xDragPosition=e.clientX,t.yDragPosition=e.clientY,t.mouseListenerFn(n)},this.touchStartListenerFn=function(e){if(!t.trackedTouch){var n=e.changedTouches[0],i=n.identifier,s=n.pageX,r=n.pageY;t.trackedTouch={id:i,currentX:s,currentY:r,xDistance:0,yDistance:0,xDirection:0,yDirection:0,xDirectionChangeCount:0,yDirectionChangeCount:0,hasThrashed:!1}}},this.touchMoveListenerFn=function(e){if(t.trackedTouch){var n=Array.from(e.changedTouches).find((function(e){var n=e.identifier;return t.trackedTouch.id===n}));if(n){var i=n.pageX,s=n.pageY,r=i-t.trackedTouch.currentX,o=s-t.trackedTouch.currentY,a=Math.sign(r),c=Math.sign(o);t.trackedTouch.xDistance+=Math.abs(r),t.trackedTouch.yDistance+=Math.abs(o),0!=a&&a!==t.trackedTouch.xDirection&&(t.trackedTouch.xDirection=a,t.trackedTouch.xDirectionChangeCount++),0!=c&&c!==t.trackedTouch.yDirection&&(t.trackedTouch.yDirection=c,t.trackedTouch.yDirectionChangeCount++),t.trackedTouch.currentX=i,t.trackedTouch.currentY=s}}},this.touchEndListenerFn=function(e){t.trackedTouch&&(Array.from(e.changedTouches).find((function(e){var n=e.identifier;return t.trackedTouch.id===n}))&&(t.trackedTouch=null))},this.isListening=!1}return e.prototype.startListening=function(t){this.isListening||(this.recordSignalCallback=t,this.xDirectionChangeCount=0,this.yDirectionChangeCount=0,this.xDistance=0,this.yDistance=0,this.xDragPosition=0,this.yDragPosition=0,this.thrashInterval=window.setInterval(this.detectThrashing,e.INTERVAL_MS),this.isThrashing=!1,window.QSI.Browser.isMobile?(window.addEventListener("touchstart",this.touchStartListenerFn),window.addEventListener("touchmove",this.touchMoveListenerFn),window.addEventListener("touchend",this.touchEndListenerFn),window.addEventListener("touchcancel",this.touchEndListenerFn)):(window.addEventListener("mousemove",this.mouseListenerFn),window.addEventListener("dragover",this.dragListenerFn)),this.isListening=!0)},e.prototype.stopListening=function(){this.isListening&&(window.clearInterval(this.thrashInterval),window.removeEventListener("mousemove",this.mouseListenerFn),window.removeEventListener("dragover",this.dragListenerFn),window.removeEventListener("touchstart",this.touchStartListenerFn),window.removeEventListener("touchmove",this.touchMoveListenerFn),window.removeEventListener("touchend",this.touchEndListenerFn),window.removeEventListener("touchcancel",this.touchEndListenerFn),this.isListening=!1,this.isThrashing=!1)},e.THRASH_SIGNAL_NAME="MouseThrash",e.INTERVAL_MS=500,e.VELOCITY_THRESHOLD=2,e.NUM_DIRECTION_CHANGES_THRESHOLD=3,e}(),g=function(){function e(){var t=this;this.elementListeners=[],this.deadClickableParents=[],this.removeListenersForTargetPathElements=function(){for(var e=0;e<t.deadClickableParents.length;e++){var n=t.deadClickableParents[e],i=t.elementListeners[e];n.removeEventListener("click",i,!0)}},this.mutationCallback=function(){window.clearTimeout(t.deadClickObserverTimeoutID),t.deadClickObserver.disconnect(),t.isObserving=!1,window.removeEventListener("scroll",t.evaluateForScroll,!1),t.removeListenersForTargetPathElements()},this.mutationTimeoutCallback=function(){t.deadClickObserver.disconnect(),t.recordSignalCallback(e.DEAD_CLICK_SIGNAL_NAME,{}),t.isObserving=!1,window.removeEventListener("scroll",t.evaluateForScroll,!1),t.removeListenersForTargetPathElements()},this.evaluateForScroll=function(e){e.currentTarget.scrollY!==t.startYPosition&&t.mutationCallback()},this.canElementBeDeadClicked=function(e){var n=e.nodeName.toUpperCase();return t.isElementInAllowlist(e,n)||t.isDeadClickableAnchorTag(e,n)},this.isElementInAllowlist=function(t,n){var i=t.role,s=i?i.toUpperCase():null;return e.DEAD_CLICK_ALLOWLIST.has(n)||e.DEAD_CLICK_ALLOWLIST.has(s)},this.isNotHTTPSProtocol=function(e){var t=document.createElement("a");t.href=e.href;var n=t.protocol;return"https:"!==n&&"http:"!==n},this.isDownloadable=function(e){return void 0!==e.download},this.isDeadClickableAnchorTag=function(e,n){if("A"!==n||t.isNotHTTPSProtocol(e)||t.isDownloadable(e))return!1;if(!e.href)return!0;var i=e.target;return i?"_blank"!==i:!t.openNewTabByDefault},this.clickedDeadClickableElement=function(){t.isObserving||(t.startYPosition=window.scrollY,window.addEventListener("scroll",t.evaluateForScroll,!1),t.isObserving=!0,t.deadClickObserver.observe(document.body,e.DEAD_CLICK_OBSERVER_CONFIG),t.deadClickObserverTimeoutID=window.setTimeout(t.mutationTimeoutCallback,e.DEAD_CLICK_OBSERVER_TIMEOUT))},this.deadClickSignalListenerFn=function(n){for(var i=n.composedPath().slice(0,e.DEAD_CLICK_PARENT_LIMIT),s=void 0,r=0;r<i.length;r++)if((s=i[r]).nodeName){if("BODY"===s.nodeName.toUpperCase())break;if(t.canElementBeDeadClicked(s)){var o=function(){t.clickedDeadClickableElement()};t.deadClickableParents.push(s),t.elementListeners.push(o),s.addEventListener("click",o,!0)}}},this.isListening=!1,this.startYPosition=window.scrollY;var n=document.querySelector("base"),i=!!n&&n.target;this.openNewTabByDefault=!!i&&"_blank"===i.toLowerCase()}return e.prototype.startListening=function(e){this.isListening||(this.isObserving=!1,this.recordSignalCallback=e,this.deadClickObserver=new MutationObserver(this.mutationCallback),window.QSI.Browser.isMobile?window.addEventListener("pointerup",this.deadClickSignalListenerFn,!0):window.addEventListener("click",this.deadClickSignalListenerFn,!0),this.isListening=!0)},e.prototype.stopListening=function(){this.isListening&&(window.removeEventListener("pointerup",this.deadClickSignalListenerFn,!0),window.removeEventListener("click",this.deadClickSignalListenerFn,!0),this.isListening=!1,this.isObserving=!1,window.clearTimeout(this.deadClickObserverTimeoutID),this.deadClickObserverTimeoutID=null)},e.DEAD_CLICK_SIGNAL_NAME="DeadClick",e.DEAD_CLICK_ALLOWLIST=new Set(["BUTTON"]),e.DEAD_CLICK_OBSERVER_CONFIG={attributes:!0,childList:!0,subtree:!0},e.DEAD_CLICK_OBSERVER_TIMEOUT=2e3,e.DEAD_CLICK_PARENT_LIMIT=100,e}(),f=function(e,t){for(var n=0,i=t.length,s=e.length;n<i;n++,s++)e[s]=t[n];return e},v=function(){function e(e){var t=this;this.customEventListenerFn=function(e){t.recordSignalCallback(t.customSignalsDictionary[e.type].signalId,{})},this.customSignalsDictionary=Object.assign.apply(Object,f([{}],e.map((function(e){var t;return(t={})[e.signalKey]=e,t})))),this.isListening=!1}return e.prototype.startListening=function(e){if(!this.isListening){for(var t in this.recordSignalCallback=e,this.customSignalsDictionary)window.addEventListener(t,this.customEventListenerFn);this.isListening=!0}},e.prototype.stopListening=function(){if(this.isListening){for(var e in this.customSignalsDictionary)window.removeEventListener(e,this.customEventListenerFn);this.isListening=!1}},e}();!function(e){e.IPAddress="IPAddress"}(r||(r={})),function(e){e.StartingUrl="StartingUrl",e.Device="Device",e.UserAgent="UserAgent",e.Referrer="Referrer",e.ExtRefId="ExtRefId",e.DirectoryId="DirectoryId"}(o||(o={}));var p=n(43),E=n(23);function I(e){var t=e.metadataName,n=e.metadataSource,i=[{name:t,value:e.metadataSourceValue,type:n}],s=E.a.generateDynamicEmbeddedData(i);return void 0===s[t]?null:s[t]}var T=n(36);n.d(t,"SESSION_INIT_STATUS",(function(){return m})),n.d(t,"PLAYBACK_INGEST_STATUS",(function(){return w})),n.d(t,"SessionRecorder",(function(){return y})),n.d(t,"initSR",(function(){return L})),n.d(t,"Uint8ToString",(function(){return D})),n.d(t,"packEvents",(function(){return R}));var m,w,C=function(){return(C=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},b=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},k=function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},_=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};!function(e){e.THROTTLED="THROTTLED",e.SUCCESS="SUCCESS"}(m||(m={})),function(e){e.THROTTLED="THROTTLED",e.SUCCESS="SUCCESS"}(w||(w={}));var y=function(){function e(t){var n=t.brandId,i=t.brandDc,s=t.zoneId,r=t.siBaseUrl,o=t.cookieDomain,u=t.configuration,d=t.brandBaseUrl,l=t.errorCallback,h=t.resolveSessionStartCallback,S=t.rejectSessionStartCallback;switch(this.sessionInfo=null,this.nextChunkSequenceNumber=0,this.isInitialized=!1,this.isRecording=!1,this.isSavingToBackend=!1,this.isWindowUnloading=!1,this.playbackEvents=[],this.chunkTimeline=[],this.qsiCookieUtilities=new c.a,this.brandId=n,this.brandDc=i,this.zoneId=s,this.timelineHelper=new a,this.errorCallback=l,this.resolveSessionStartCallback=h,this.rejectSessionStartCallback=S,null==window.QSI.setTestSessionError&&(window.QSI.setTestSessionError=function(){}),r){case"https://s1.b1-prv.qualtrics.com":this.siBaseUrl="https://sr.b1-prv.qualtrics.com";break;case"https://s1.st3.qualtrics.com":case"https://s1.g1-iad.qualtrics.com":case"https://s1.g1-cmh.qualtrics.com":this.siBaseUrl="https://sr.st3.qualtrics.com";break;default:this.siBaseUrl="https://sr.qualtrics.com"}switch("qpsb1"===n&&(this.siBaseUrl="https://sr.b1-prv.qualtrics.com",this.brandDc="b1-prv"),this.cookieDomain=o,this.brandBaseUrl=d,this.sessionInfoCookieName=""+e.SESSION_INFO_COOKIE_NAME_PREFIX+this.zoneId,this.sessionThrottledCookieName=""+e.SESSION_THROTTLED_COOKIE_NAME_PREFIX+this.zoneId,this.sessionSampledOutCookieName=""+e.SESSION_SAMPLEDOUT_COOKIE_NAME_PREFIX+this.zoneId,this.chunkInterval=e.PLAYBACK_DATA_PERSISTENCE_INTERVAL_SECONDS_DEFAULT,this.configuration=u,!0){case window.QSI.global.featureFlags["DX.PepperPotts_Interval_A"]:this.chunkInterval=e.PLAYBACK_DATA_PERSISTENCE_INTERVAL_SECONDS_A;break;case window.QSI.global.featureFlags["DX.PepperPotts_Interval_B"]:this.chunkInterval=e.PLAYBACK_DATA_PERSISTENCE_INTERVAL_SECONDS_B;break;case window.QSI.global.featureFlags["DX.PepperPotts_Interval_C"]:this.chunkInterval=e.PLAYBACK_DATA_PERSISTENCE_INTERVAL_SECONDS_C}}return e.prototype.getSiBaseUrl=function(){return this.siBaseUrl},e.prototype.validateSession=function(){return b(this,void 0,void 0,(function(){var e,t,n,i,s,r,o,a;return k(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),this.isInitialized?[2]:(e=this.qsiCookieUtilities.get(this.sessionInfoCookieName))?(t=JSON.parse(e),n=t.nextChunkSequenceNumber,i=_(t,["nextChunkSequenceNumber"]),s=this.siBaseUrl,this.setDatacenterBaseUrl(i.creationDataCenter),r={brandId:this.brandId,sessionId:i.sessionId,expectedNextChunkSequenceNumber:n},[4,this.makeValidateSessionRequest(r)]):[2];case 1:return!0===(o=c.sent()).isValidSession?(this.initializeSessionInfo(i),this.nextChunkSequenceNumber=o.validatedSessionData.nextChunkSequenceNumber,this.persistReplaySessionInfoToCookie(),this.resolveSessionStartCallback(i.sessionId)):(this.qsiCookieUtilities.erase(this.sessionInfoCookieName,this.cookieDomain),this.siBaseUrl=s),[3,3];case 2:throw a=c.sent(),this.setBackOffOnUnexpectedFailure(),a;case 3:return[2]}}))}))},e.prototype.checkRateLimit=function(){return b(this,void 0,void 0,(function(){var e;return k(this,(function(t){switch(t.label){case 0:return[4,this.makeCheckRateLimitRequest({brandId:this.brandId})];case 1:return(e=t.sent()).isRateLimitHit||this.setDatacenterBaseUrl(e.creationDataCenter),[2,e]}}))}))},e.prototype.makeValidateSessionRequest=function(t){return b(this,void 0,void 0,(function(){var n;return k(this,(function(i){switch(i.label){case 0:return[4,fetch(""+this.siBaseUrl+e.SESSION_VALIDATE_API_PATH,{method:"PUT",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return n=i.sent(),[4,this.parseSessionValidateServerResponse(n)];case 2:return[2,i.sent()]}}))}))},e.prototype.makeCheckRateLimitRequest=function(t){return b(this,void 0,void 0,(function(){var n;return k(this,(function(i){switch(i.label){case 0:return[4,fetch(""+this.siBaseUrl+e.SESSION_CHECK_RATE_LIMIT_PATH+"/"+t.brandId,{method:"GET",mode:"cors",headers:{"Content-Type":"application/json"}})];case 1:return n=i.sent(),[4,this.parseSessionCheckRateLimitResponse(n)];case 2:return[2,i.sent()]}}))}))},e.prototype.notAllowedToInitialize=function(){return!(this.isTestSession()||!this.qsiCookieUtilities.get(this.sessionThrottledCookieName)&&!this.qsiCookieUtilities.get(this.sessionSampledOutCookieName))},e.prototype.setSampledOutBackoff=function(){this.qsiCookieUtilities.set(this.sessionSampledOutCookieName,"true",null,this.cookieDomain,{secure:!0})},e.prototype.parseSessionValidateServerResponse=function(e){var t;return b(this,void 0,void 0,(function(){var n;return k(this,(function(i){switch(i.label){case 0:if(200!==e.status)throw new Error("Received unexpected HTTP code from call to server: "+e.status);return[4,e.json()];case 1:if("boolean"!=typeof(null==(n=i.sent())?void 0:n.isValidSession))throw new Error("Received invalid isValidSession value from Session Validation Response: "+JSON.stringify(n));if(!0===n.isValidSession&&"number"!=typeof(null===(t=n.validatedSessionData)||void 0===t?void 0:t.nextChunkSequenceNumber))throw new Error("Received invalid validatedSessionData from Session Validation Response: "+JSON.stringify(n));return[2,n]}}))}))},e.prototype.parseSessionCheckRateLimitResponse=function(e){return b(this,void 0,void 0,(function(){var t;return k(this,(function(n){switch(n.label){case 0:if(200!==e.status)throw new Error("Received unexpected HTTP code from call to server: "+e.status);return[4,e.json()];case 1:if("boolean"!=typeof(null==(t=n.sent())?void 0:t.isRateLimitHit))throw new Error("Received invalid response with 200 server response - isRateLimit was not boolean: "+JSON.stringify(t));if("string"!=typeof(null==t?void 0:t.creationDataCenter))throw new Error("Received invalid response with 200 server response - creationDataCenter was not string: "+JSON.stringify(t));return[2,t]}}))}))},e.prototype.setRecordingBackoff=function(t){!this.isTestSession()&&this.qsiCookieUtilities.set(this.sessionThrottledCookieName,"true",t/e.SECONDS_IN_A_DAY,this.cookieDomain,{secure:!0}),this.qsiCookieUtilities.erase(this.sessionInfoCookieName,this.cookieDomain)},e.prototype.initializeSessionInfo=function(e){for(this.sessionInfo=e,this.setDatacenterBaseUrl(this.sessionInfo.creationDataCenter),this.isInitialized=!0;window.QSI.targetWindows.length;){var t=window.QSI.targetWindows.pop();Object(T.persistEDToSurvey)(t,"Q_SR_ID",this.getId()),Object(T.persistEDToSurvey)(t,"Q_SR_PlaybackUrl",this.getPlaybackUrl())}},e.prototype.setBackOffOnUnexpectedFailure=function(){this.setRecordingBackoff(e.BACKOFF_SECONDS_ON_UNEXPECTED_FAILURE)},e.prototype.setDatacenterBaseUrl=function(e){["a1-prv","b1-prv","g1-cmh"].includes(e)||(this.siBaseUrl="https://"+e+".sr.qualtrics.com")},e.prototype.startRecording=function(t){return b(this,void 0,void 0,(function(){var i,s,r,o=this;return k(this,(function(a){switch(a.label){case 0:return this.isRecording?(this.rejectSessionStartCallback("Session already recording"),[2]):[4,Promise.resolve().then(n.t.bind(null,44,7))];case 1:return i=a.sent().record,s=!this.configuration||this.configuration.shouldMaskInputFields,r=this.configuration?this.configuration.cssSelectorsToMask:"",this.stopsirrwebRecorder=i({emit:function(t){o.lastChunkEventTimestampEpoch=t.timestamp;var n=o.timelineHelper.generateTimelineEvent(t,o.nextChunkSequenceNumber);null!=n&&o.chunkTimeline.push(n);var i=o.playbackEvents.length,s=JSON.stringify(o.playbackEvents).length,r=JSON.stringify(t).length;if(s+r>e.PLAYBACK_EVENTS_CIRCUIT_BREAKER_THRESHOLD_BYTES)return o.errorCallback(new Error("Playback data accruing too fast for Zone:"+o.zoneId+". Exceeded threshold:"+e.PLAYBACK_EVENTS_CIRCUIT_BREAKER_THRESHOLD_BYTES+" bytes. Tried adding new event of "+r+" bytes to queue with "+s+" bytes ("+i+" events)Stopping recording")),o.stopRecording(),window.QSI.setTestSessionError(new Error("")),o.setBackOffOnUnexpectedFailure(),void o.rejectSessionStartCallback("");o.playbackEvents.push(t)},maskAllInputs:s,blockSelector:r}),window.setTimeout((function(){return b(o,void 0,void 0,(function(){return k(this,(function(e){switch(e.label){case 0:return[4,this.persistEventsToBackend()];case 1:return e.sent(),[2]}}))}))}),1e3*e.PLAYBACK_DATA_INITIAL_PERSISTENCE_SECONDS),this.saveToBackendFunctionId=window.setInterval((function(){return b(o,void 0,void 0,(function(){return k(this,(function(e){switch(e.label){case 0:return[4,this.persistEventsToBackend()];case 1:return e.sent(),[2]}}))}))}),1e3*this.chunkInterval),this.windowBeforeUnloadListener=function(){o.isWindowUnloading=!0,clearInterval(o.saveToBackendFunctionId),o.persistEventsToBackendBeacon()},addEventListener("beforeunload",this.windowBeforeUnloadListener),this.registerSignalListeners(i.addCustomEvent,t),this.isRecording=!0,[2]}}))}))},e.prototype.registerSignalListeners=function(e,t){this.signalListeners=t,this.signalListeners.forEach((function(t){t.startListening((function(t,n){e(t,n),window.QSI.global.featureFlags["DX.PepperPotts_TestingTools"]&&console.log(t+" detected!")}))}))},e.prototype.persistEventsToBackend=function(){return b(this,void 0,void 0,(function(){var t,n,i,s,r,o,a,c,u,d;return k(this,(function(l){switch(l.label){case 0:if(this.isSavingToBackend)return!1===this.isInitialized&&this.rejectSessionStartCallback(""),[2];if(0===this.playbackEvents.length)return!1===this.isInitialized&&this.rejectSessionStartCallback(""),[2];this.isSavingToBackend=!0,t=this.playbackEvents,n=this.nextChunkSequenceNumber,i=this.timelineHelper.generateChunkEndMarker(this.lastChunkEventTimestampEpoch,n),this.chunkTimeline.push(i),s=this.chunkTimeline,this.playbackEvents=[],this.chunkTimeline=[],this.nextChunkSequenceNumber++,l.label=1;case 1:return l.trys.push([1,7,8,9]),r=R(t),this.isInitialized?[3,3]:(o={events:r,chunkNumber:n},[4,this.createSession(o,s)]);case 2:return l.sent(),[3,6];case 3:return this.persistReplaySessionInfoToCookie(),[4,fetch(""+this.siBaseUrl+e.PUT_RECORD_PLAYBACK_API_PATH,{method:"PUT",headers:{"Content-Type":"application/json"},body:this.buildPersistEventRequestBody({sessionId:this.sessionInfo.sessionId,events:r,chunkNumber:n,brandDc:this.brandDc,brandId:this.brandId,zoneId:this.zoneId,chunkTimeline:s})})];case 4:return a=l.sent(),[4,this.parsePlaybackIngestionServerResponse(a)];case 5:if((c=l.sent()).status===w.THROTTLED)return this.stopRecording(),u="Throttling playback data due to high load for Zone:"+this.zoneId+"}",window.QSI.setTestSessionError(new Error(u)),this.errorCallback(new Error(u)),this.setRecordingBackoff(c.backOffPeriodSeconds),[2];l.label=6;case 6:return[3,9];case 7:return d=l.sent(),this.isWindowUnloading||(this.errorCallback(new Error("Failed to persist playback data to backend for Zone:"+this.zoneId+": "+d.toString())),this.stopRecording(),window.QSI.setTestSessionError(new Error("")),this.setBackOffOnUnexpectedFailure()),!1===this.isInitialized&&this.rejectSessionStartCallback(""),[3,9];case 8:return this.isSavingToBackend=!1,[7];case 9:return[2]}}))}))},e.prototype.persistEventsToBackendBeacon=function(){if(this.isInitialized&&!this.isSavingToBackend&&0!==this.playbackEvents.length){var t=this.timelineHelper.generateChunkEndMarker(this.lastChunkEventTimestampEpoch,this.nextChunkSequenceNumber);this.chunkTimeline.push(t),navigator.sendBeacon(""+this.siBaseUrl+e.POST_RECORD_PLAYBACK_API_PATH,this.buildPersistEventRequestBody({sessionId:this.sessionInfo.sessionId,events:R(this.playbackEvents),chunkNumber:this.nextChunkSequenceNumber,brandDc:this.brandDc,brandId:this.brandId,zoneId:this.zoneId,chunkTimeline:this.chunkTimeline}))&&(this.nextChunkSequenceNumber++,this.persistReplaySessionInfoToCookie())}},e.prototype.persistEventsAndCloseSession=function(){return b(this,void 0,void 0,(function(){var e;return k(this,(function(t){switch(t.label){case 0:return this.isInitialized?[4,this.persistEventsToBackend()]:[2];case 1:return t.sent(),this.isRecording&&this.stopRecording(),[4,this.closeSession()];case 2:return e=t.sent(),this.qsiCookieUtilities.erase(this.sessionInfoCookieName,this.cookieDomain),[2,e]}}))}))},e.prototype.persistEventsAndPauseSession=function(){return b(this,void 0,void 0,(function(){return k(this,(function(e){switch(e.label){case 0:return this.isInitialized&&this.isRecording?[4,this.persistEventsToBackend()]:[2];case 1:return e.sent(),this.isRecording&&this.stopRecording(),[2,this.sessionInfo.sessionId]}}))}))},e.prototype.persistReplaySessionInfoToCookie=function(){this.qsiCookieUtilities.set(this.sessionInfoCookieName,JSON.stringify(C(C({},this.sessionInfo),{nextChunkSequenceNumber:this.nextChunkSequenceNumber})),null,this.cookieDomain,{secure:!0})},e.prototype.closeSession=function(){return b(this,void 0,void 0,(function(){var e,t;return k(this,(function(n){switch(n.label){case 0:if(!this.isInitialized)return[2];e=this.siBaseUrl+"/sr-data-ingestion-service/v1/sessions/"+this.sessionInfo.sessionId+"/close-session",n.label=1;case 1:return n.trys.push([1,3,,4]),[4,fetch(e,{method:"POST"})];case 2:return n.sent(),[2,this.sessionInfo.sessionId];case 3:return t=n.sent(),this.errorCallback(new Error("Failed to close Session:"+this.sessionInfo.sessionId+" for Zone:"+this.zoneId+": "+t.toString())),[2,"Error closing session"];case 4:return[2]}}))}))},e.prototype.getChunkInfo=function(e){return{playbackData:e.events,playbackDataVersion:3,chunkNumber:e.chunkNumber,chunkTimeline:e.chunkTimeline}},e.prototype.isTestSession=function(){return window.QSI.Orchestrator.isTestSession},e.prototype.createSession=function(t,n){return b(this,void 0,void 0,(function(){var i,s,o,a,c,u,d,l;return k(this,(function(h){switch(h.label){case 0:return this.isInitialized?[2]:(i=t.events,s=t.chunkNumber,o=[],a={},this.configuration.customMetadata&&this.configuration.customMetadata[0]&&(c=function(e){var t=[],n={};if(!Array.isArray(e))return[t,n];for(var i=0;i<e.length;i++){var s=e[i],o=s.metadataSourceValue,a=void 0===o?null:o,c=s.metadataName,u=s.metadataSource,d=s.metadataId;if(u in r)n[d]=u,t.push({id:d,value:u});else{var l=I({metadataName:c,metadataSource:u,metadataSourceValue:a});t.push({id:d,value:l})}}return[t,n]}(this.configuration.customMetadata),o=c[0],a=c[1]),[4,fetch(""+this.siBaseUrl+e.SESSION_CREATE_API_PATH,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:this.buildCreateSessionRequestBody({isTestSession:this.isTestSession(),events:i,chunkNumber:s,brandDc:this.brandDc,brandId:this.brandId,zoneId:this.zoneId,chunkTimeline:n,customMetadata:o,metadata:this.getSessionMetadata(),customMetadataGeneratorMapping:a})})]);case 1:return u=h.sent(),[4,this.parseSessionInitServerResponse(u)];case 2:return(d=h.sent()).status===m.THROTTLED?(this.stopRecording(),this.setRecordingBackoff(d.backOffPeriodSeconds),this.rejectSessionStartCallback(""),l=new Error("Throttling playback data due to high load for Zone:"+this.zoneId+"}"),window.QSI.setTestSessionError(l),this.errorCallback(l),[2]):(this.initializeSessionInfo(d.sessionInfo),this.persistReplaySessionInfoToCookie(),this.resolveSessionStartCallback(d.sessionInfo.sessionId),[2])}}))}))},e.prototype.parseSessionInitServerResponse=function(e){return b(this,void 0,void 0,(function(){var t;return k(this,(function(n){switch(n.label){case 0:if(200!==e.status)throw new Error("Received unexpected HTTP code from call to server: "+e.status);return[4,e.json()];case 1:switch((t=n.sent()).status){case m.THROTTLED:if(!Number.isInteger(t.backOffPeriodSeconds))throw new Error("Received invalid backOffPeriod with THROTTLED server response: "+t.backOffPeriodSeconds);return[2,t];case m.SUCCESS:if(!t.sessionInfo||"string"!=typeof t.sessionInfo.sessionId||"string"!=typeof t.sessionInfo.sessionStartTime)throw new Error("Received invalid sessionInfo with SUCCESS server response: "+t.sessionInfo);return[2,t];default:throw new Error("Received unexpected status message from server: "+status)}return[2]}}))}))},e.prototype.buildCreateSessionRequestBody=function(e){var t=e.isTestSession,n=e.events,i=e.chunkNumber,s=e.brandDc,r=e.brandId,o=e.zoneId,a=e.chunkTimeline,c={isTestSession:t,brandId:r,brandDc:s,zoneId:o,customMetadata:e.customMetadata,metadata:e.metadata,customMetadataGeneratorMapping:e.customMetadataGeneratorMapping,chunkInfo:this.getChunkInfo({events:n,chunkNumber:i,chunkTimeline:a})};return JSON.stringify(c)},e.prototype.buildPersistEventRequestBody=function(e){var t=e.sessionId,n=e.events,i=e.chunkNumber,s=e.brandDc,r=e.brandId,o=e.zoneId,a=e.chunkTimeline,c=this.getChunkInfo({events:n,chunkNumber:i,chunkTimeline:a}),u=C({brandDc:s,brandId:r,zoneId:o,sessionId:t},c);return JSON.stringify(u)},e.prototype.parsePlaybackIngestionServerResponse=function(e){return b(this,void 0,void 0,(function(){var t,n;return k(this,(function(i){switch(i.label){case 0:if(200!==e.status)throw new Error("Received unexpected HTTP code from call to server: "+e.status);return[4,e.json()];case 1:switch((t=i.sent()).status){case w.THROTTLED:if(n=t.backOffPeriodSeconds,!Number.isInteger(n))throw new Error("Received invalid backOffPeriodSeconds with THROTTLED server response: "+n);return[2,t];case w.SUCCESS:return[2,t];default:throw new Error("Received unexpected status message from server: "+status)}return[2]}}))}))},e.prototype.stopRecording=function(){this.isRecording&&(clearInterval(this.saveToBackendFunctionId),this.stopsirrwebRecorder(),removeEventListener("beforeunload",this.windowBeforeUnloadListener),this.playbackEvents=[],this.signalListeners.forEach((function(e){e.stopListening()})),this.isRecording=!1)},e.prototype.isSessionInitialized=function(){return this.isInitialized},e.prototype.getRecordedEvents=function(){return this.playbackEvents},e.prototype.getRecordedChunkTimeline=function(){return this.chunkTimeline},e.prototype.getId=function(){return this.sessionInfo?this.sessionInfo.sessionId:null},e.prototype.getPlaybackUrl=function(){var e,t=null===(e=this.brandBaseUrl)||void 0===e?void 0:e.replace(/\/$/,"");return this.sessionInfo&&this.brandBaseUrl&&this.zoneId?t+"/siui/project/"+this.zoneId+"/sr/session/"+this.sessionInfo.sessionId:null},e.prototype.isOn=function(){return this.isRecording},e.prototype.getSessionMetadata=function(){var e,t=this,n=function(e){return null===e?null:(e.length>=255&&(e=e.slice(0,252)+"..."),e)},i=window.location.href,s=window.QSI.Browser.isMobile?"Mobile":"Desktop",r=window.navigator?window.navigator.userAgent:"",a=window.document.referrer?window.document.referrer:null,c=window.QSI.config.externalReference?window.QSI.config.externalReference:null,u=(e=this.configuration.directoryId,!0===t.configuration.linkWithXMD&&window.QSI.global.featureFlags["DX.PepperPotts_XMD"]&&void 0!==e?e:null);return[{id:o.StartingUrl,value:n(i)},{id:o.Device,value:n(s)},{id:o.UserAgent,value:n(r)},{id:o.Referrer,value:n(a)},{id:o.ExtRefId,value:n(c)},{id:o.DirectoryId,value:n(u)}]},e.prototype.doSamplingRateComparison=function(){var e=this.configuration&&this.configuration.samplingRate?this.configuration.samplingRate:0;return Math.random()<e/100},e.SESSION_INFO_COOKIE_NAME_PREFIX="QSI_ReplaySession_Info_",e.SESSION_THROTTLED_COOKIE_NAME_PREFIX="QSI_ReplaySession_Throttled_",e.SESSION_SAMPLEDOUT_COOKIE_NAME_PREFIX="QSI_ReplaySession_SampledOut_",e.SESSION_VALIDATE_API_PATH="/sr-data-ingestion-service/v1/sessions/validate",e.SESSION_CHECK_RATE_LIMIT_PATH="/sr-data-ingestion-service/v1/rate-limit/check-rate-limit",e.SESSION_CREATE_API_PATH="/sr-data-ingestion-service/v1/sessions/create",e.SESSION_IS_TEST_SESSION_COOKIE_NAME_PREFIX="QSI_TestSessions_",e.PUT_RECORD_PLAYBACK_API_PATH="/sr-data-ingestion-service/v1/sessions/record-playback",e.POST_RECORD_PLAYBACK_API_PATH="/sr-data-ingestion-service/v1/sessions/record-playback/beacon",e.SECONDS_IN_A_DAY=86400,e.BACKOFF_SECONDS_ON_UNEXPECTED_FAILURE=60,e.PLAYBACK_DATA_INITIAL_PERSISTENCE_SECONDS=2,e.PLAYBACK_DATA_PERSISTENCE_INTERVAL_SECONDS_DEFAULT=10,e.PLAYBACK_DATA_PERSISTENCE_INTERVAL_SECONDS_A=15,e.PLAYBACK_DATA_PERSISTENCE_INTERVAL_SECONDS_B=20,e.PLAYBACK_DATA_PERSISTENCE_INTERVAL_SECONDS_C=30,e.PLAYBACK_EVENTS_CIRCUIT_BREAKER_THRESHOLD_BYTES=1e7,e}(),L=function(e){return b(void 0,void 0,void 0,(function(){var t,n,i,s,r,o,a,c,f,p,E,I,T;return k(this,(function(m){switch(m.label){case 0:if((t=new y(e)).notAllowedToInitialize())return e.rejectSessionStartCallback(""),[2];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,t.validateSession()];case 2:return m.sent(),[3,4];case 3:return n=m.sent(),T="Failed to validate session for "+e.zoneId+": "+n.toString(),e.errorCallback(new Error(T)),e.rejectSessionStartCallback(T),[3,4];case 4:if(!t.isSessionInitialized()&&!t.doSamplingRateComparison()&&!t.isTestSession())return t.setSampledOutBackoff(),e.rejectSessionStartCallback(""),[2];m.label=5;case 5:return m.trys.push([5,7,,8]),[4,t.checkRateLimit()];case 6:return m.sent().isRateLimitHit?[2]:[3,8];case 7:return i=m.sent(),T="Failed to check rate limit for "+e.brandId+": "+i.toString(),e.errorCallback(new Error(T)),e.rejectSessionStartCallback(T),[2];case 8:return m.trys.push([8,10,,11]),s=new u,r=new d,o=new l,a=new h,c=new S,f=new g,p=[s,r,o,a,c,f],t.configuration&&t.configuration.customSignal&&(E=new v(t.configuration.customSignal),p.push(E)),[4,t.startRecording(p)];case 9:return m.sent(),window.QSI.SR=t,[3,11];case 10:return I=m.sent(),T="Failed during startRecording of session recorder for "+e.zoneId+": "+I.toString(),e.rejectSessionStartCallback(T),e.errorCallback(new Error(T)),[3,11];case 11:return[2]}}))}))},D=function(e){for(var t=[],n=0;n<e.length;n+=32768)t.push(String.fromCharCode.apply(null,e.subarray(n,n+32768)));return t.join("")},R=function(e){return btoa(D(Object(p.a)(JSON.stringify(e))))}}}]);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}